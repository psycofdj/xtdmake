<html>
  <head>
    <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="bower_components/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet">
    <link href="bower_components/bootstrap-treeview/dist/bootstrap-treeview.min.css" rel="stylesheet">
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="bower_components/bootstrap-treeview/dist/bootstrap-treeview.min.js"></script>
    <script src="data.js"></script>
    <style>
     .list-group-item {
       padding:5px 10px;
     }
     body {
       border-right:1px #ddd solid;
     }
    </style>

    <script lang="javascript">
     $.extend({
       getUrlVars: function(){
         var vars = [], hash;
         var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
         for(var i = 0; i < hashes.length; i++)
           {
             hash = hashes[i].split('=');
             vars.push(hash[0]);
             vars[hash[0]] = hash[1];
           }
         return vars;
       },
       getUrlVar: function(name){
         return $.getUrlVars()[name];
       }
     });

     $(document).ready(function() {
       var tree = []
       var l_nodeID = 0;
       if (!g_data) {
         g_data = []
       }
       $.each(g_data, function(c_idx, c_item) {
         var l_parentID = l_nodeID;
         var l_childs = [];
         $.each(c_item.childs, function(c_idx, c_child) {
           var l_text = c_child.name;
           if (c_child.label) {
             l_text += " (" + c_child.label + ")";
           }

           var l_child = {
             text : l_text,
             href : "#",
             src : c_child.file
           }

           l_child.icon = "";
           if (c_child.status) {
             if (c_child.status == "success") {
               l_child.backColor = "#dff0d8";
               l_child.icon = "glyphicon glyphicon-thumbs-up";
             } else if (c_child.status == "failure") {
               l_child.backColor = "#f2dede";
               l_child.icon = "glyphicon glyphicon-thumbs-down";
             } else {
               l_child.backColor = "#fcf8e3";
               l_child.icon = "glyphicon glyphicon-warning-sign";
             }
           } else {
             l_child.backColor = "#f1f1f1";
           }
           l_childs.push(l_child);
           l_nodeID += 1;
         });
         tree.push({
           text :  c_item.name,
           backColor: "#d9edf7",
           nodes : l_childs
         });
         l_nodeID += 1;
       });

       tree.push({
         text :  "Graphs",
         backColor: "#d9edf7",
         href : "#",
         src : "./view.html",
         nodes : []
       });

       $('#tree').treeview({
         data: tree,
         levels:2
       });


       $(".node-tree").click(function(p_event) {
         var l_id   = $(this).data("nodeid");
         var l_node = $('#tree').treeview("getNode", l_id);
         if (l_node.src) {
           if (p_event.which == 2) {
             window.open(l_node.src, "_blank");
           } else {
             top.frames["droite"].location.href = l_node.src;
           }
         }
           p_event.preventDefault();
         p_event.stopPropagation();
         return true;
       });
     });
    </script>
  </head>
  <body>
    <div id="tree"></div>
  </body>
</html>
